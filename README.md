# Mips Pipeline CPU

## 设计目标
本实验设计实现了基于 MIPS32 指令集架构的处理器，设计的 CPU 具有以下特点：

1. 采用数据、指令存储器接口分开的哈佛结构；
2. 采用五级流水线结构，包含：取指、译码、执行、访存、写回
3. 包含 16 条基本 MIPS 指令
6. 按字（32位）寻址

## 实验环境

* 硬件描述语言：Verilog HDL
* 仿真环境：Vivado 2019.2

## 实验步骤
各模块如下图所示
![image-20211003183804850](https://i.loli.net/2021/10/03/rMKXBpqud4SOEUG.png)

## 仿真

1. 初始化 ROM IP核：使用 test 文件夹中的 `test.coe` 初始化 ROM

   用于测试的 MIPS 程序如下：

   ```assembly
   lui $1, 0x0001
   addiu $2, $0, 2
   sw $1, 0x7000
   lw $3, 0x7000               # load 相关 (3,4)
   beq $1, $3 next
   next:
       addi $4, $0, 0x0003 		
       andi $5, $4, 0xff00     # 相邻数据相关 (7,8)
       ori $6, $4, 0xff00      # 隔一条数据相关 (7,9)
       xori $7, $4, 0xff00     # 隔两条数据相关 (7,10)
       add $8, $6, $7          # 相邻数据相关 + 隔一条数据相关 (10,11)
       and $9, $8, $7          # 相邻数据相关 + 隔一条数据相关
       or $10, $8, $9          # 相邻数据相关 + 隔一条数据相关 
       xor $11, $8, $9         # 隔一条数据相关 + 隔两条数据相关
       nor $12, $8, $9         # 隔两条数据相关
       j exit 
   exit:
       addi $13, $0, 0x4c 
       jr $13
       lui $14, 0x5678         # 控制相关：不应该被执行
       lui $14, 0x1000         # 控制相关：不应该被执行
       lui $14, 0x1234         # 指令地址是 0x4c 
   ```

2. 使用 `tb_pipeline.v` 仿真。

